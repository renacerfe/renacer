<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblia Reina-Valera 1960 - @Renacer</title>
    <style>
        :root {
            --wood-dark: #4b3621;
            --wood-mid: #7a5230;
            --wood-light: #a67c52;
            --parchment-bg: #f4ecd8;
            --parchment-paper: #fdfbf7;
            --text-ink: #2c1e12;
            --gold-accent: #d4af37;
            --shadow-soft: 0 2px 4px rgba(0,0,0,0.15);
            --shadow-deep: 0 8px 16px rgba(0,0,0,0.3);
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--wood-dark);
            color: var(--text-ink);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        header {
            background: linear-gradient(180deg, #2d1b14 0%, #4b3621 100%);
            color: var(--gold-accent);
            padding: 1rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            border-bottom: 2px solid #1a0f0a;
            position: relative;
            z-index: 20;
            flex-shrink: 0;
        }

        header h1 {
            margin: 0;
            font-size: 1.6rem;
            font-family: 'Georgia', serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .container {
            display: flex;
            flex: 1;
            overflow: hidden; /* Para que el scroll sea interno */
            background-color: var(--wood-mid);
            position: relative;
        }

        /* Sidebar de Libros */
        .sidebar {
            width: 280px;
            background: #4e342e;
            background-image: linear-gradient(90deg, rgba(0,0,0,0.2) 0%, transparent 5%, transparent 95%, rgba(0,0,0,0.2) 100%);
            border-right: 4px solid #2d1b14;
            display: flex;
            flex-direction: column;
            box-shadow: inset -10px 0 20px rgba(0,0,0,0.3);
            z-index: 10;
        }

        .sidebar-header {
            padding: 15px;
            background: #3e2723;
            color: #d7ccc8;
            text-align: center;
            font-family: 'Georgia', serif;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid #5d4037;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            flex-shrink: 0;
        }

        .book-list {
            list-style: none;
            padding: 10px;
            margin: 0;
            overflow-y: auto;
            flex: 1;
        }

        /* Scrollbar estilizado para sidebar */
        .book-list::-webkit-scrollbar { width: 8px; }
        .book-list::-webkit-scrollbar-track { background: #3e2723; }
        .book-list::-webkit-scrollbar-thumb { background: #8d6e63; border-radius: 4px; }

        .book-btn {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 4px;
            text-align: left;
            background: linear-gradient(to right, #5d4037, #6d4c41);
            border: none;
            border-left: 4px solid #3e2723; /* Lomo oscuro */
            border-bottom: 1px solid #4e342e;
            color: #efebe9;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            font-family: 'Segoe UI', sans-serif;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .book-btn:hover {
            background: linear-gradient(to right, #6d4c41, #795548);
            padding-left: 20px; /* Efecto de sacar el libro */
            color: #fff;
        }

        .book-btn.active {
            background: linear-gradient(to right, #d4af37, #fbc02d);
            color: #212121;
            border-left: 4px solid #f57f17;
            font-weight: bold;
            text-shadow: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        /* Área Principal */
        .main-content {
            flex: 1;
            padding: 0;
            overflow-y: auto;
            background-color: var(--parchment-bg);
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
            display: flex;
            justify-content: center;
        }

        .main-content::-webkit-scrollbar { width: 10px; }
        .main-content::-webkit-scrollbar-track { background: #e0e0e0; }
        .main-content::-webkit-scrollbar-thumb { background: #a1887f; border-radius: 5px; }

        #content-area {
            width: 100%;
            max-width: 900px;
            padding: 40px;
            background-color: var(--parchment-paper);
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
            min-height: 100%;
        }

        /* Vista de Capítulos */
        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(55px, 1fr));
            gap: 12px;
            padding: 10px 0;
        }

        .chapter-btn {
            background: #fff;
            border: 1px solid #d7ccc8;
            border-bottom: 3px solid #a1887f;
            border-radius: 6px;
            padding: 12px 0;
            text-align: center;
            font-family: 'Georgia', serif;
            font-size: 1.1rem;
            color: #5d4037;
            cursor: pointer;
            transition: all 0.1s;
        }

        .chapter-btn:hover {
            background: #fff3e0;
            border-color: #ffb74d;
            border-bottom-color: #f57c00;
            transform: translateY(-1px);
            color: #e65100;
        }
        
        .chapter-btn:active {
            transform: translateY(2px);
            border-bottom-width: 1px;
        }

        /* Vista de Versículos */
        .verse-container {
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 1.8;
            font-size: 1.2rem;
            color: #212121;
        }

        .verse {
            margin-bottom: 15px;
            text-indent: -1.5em;
            padding-left: 1.5em;
        }

        .verse-num {
            display: inline-block;
            width: 1.5em;
            font-weight: bold;
            color: #a1887f;
            font-size: 0.8em;
        }

        .nav-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            border-bottom: 2px solid #dccbb5;
            padding-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .back-btn {
            background: linear-gradient(to bottom, #5d4037, #4e342e);
            color: #fff;
            border: 1px solid #3e2723;
            border-bottom: 3px solid #2d1b14;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            transition: transform 0.1s;
        }

        .back-btn:active {
            transform: translateY(2px);
            border-bottom-width: 1px;
        }

        .book-title {
            font-family: 'Georgia', serif;
            font-size: 2.2rem;
            color: #3e2723;
            margin: 0;
            text-shadow: 1px 1px 0 rgba(255,255,255,0.5);
        }
        
        /* Estilos para elementos dinámicos */
        #content-area h3 {
            color: #4b3621;
            border-bottom: 1px solid #a67c52;
            padding-bottom: 5px;
            font-family: 'Georgia', serif;
            margin-top: 30px;
            font-size: 1.4rem;
        }
        
        #content-area p em {
            color: #5d4037;
            font-family: 'Georgia', serif;
            font-size: 1.1rem;
        }

        .loading, .error-msg {
            text-align: center;
            padding: 30px;
            font-family: 'Segoe UI', sans-serif;
            color: #5d4037;
        }
        
        .error-msg {
            background: #ffebee;
            border: 1px solid #ef9a9a;
            border-radius: 8px;
            color: #c62828;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                max-height: 35vh; /* Ocupa máx 35% de la pantalla */
                border-right: none;
                border-bottom: 4px solid #2d1b14;
            }

            .book-list {
                display: flex;
                flex-wrap: wrap;
                padding: 5px;
                align-content: flex-start;
            }

            .book-btn {
                width: auto;
                flex: 1 0 45%; /* 2 columnas en móvil */
                margin: 2px;
                font-size: 0.9rem;
                padding: 10px;
                border-left: none;
                border-bottom: 2px solid #3e2723;
                border-radius: 4px;
                text-align: center;
            }
            
            .book-btn:hover {
                padding-left: 10px; /* Reset hover effect for mobile */
            }

            .main-content {
                padding: 0;
            }

            #content-area {
                padding: 20px;
                box-shadow: none;
            }

            .book-title {
                font-size: 1.5rem;
            }

            .verse {
                padding-left: 0;
                text-indent: 0;
            }
            
            .verse-num {
                display: inline-block;
                margin-right: 5px;
                width: auto;
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>Biblia Reina-Valera 1960</h1>
    </header>

    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">Libros</div>
            <div id="book-menu" class="book-list">
                <!-- Los botones de los libros se generarán aquí -->
            </div>
        </aside>

        <main id="main-content" class="main-content">
            <div id="content-area">
                <div style="text-align: center; margin-top: 50px; color: #777;">
                    <h2>Bienvenido</h2>
                    <p>Selecciona un libro del menú de la izquierda para comenzar a leer.</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Lista de libros y sus nombres de archivo esperados (basado en convenciones comunes y ejemplos del prompt)
        const BOOK_MAP = [
            // Antiguo Testamento
            { name: "Génesis", file: "gn" }, { name: "Éxodo", file: "ex" }, { name: "Levítico", file: "lv" },
            { name: "Números", file: "nm" }, { name: "Deuteronomio", file: "dt" }, { name: "Josué", file: "jos" },
            { name: "Jueces", file: "jue" }, { name: "Rut", file: "rt" }, { name: "1 Samuel", file: "1s" },
            { name: "2 Samuel", file: "2s" }, { name: "1 Reyes", file: "1r" }, { name: "2 Reyes", file: "2r" },
            { name: "1 Crónicas", file: "1c" }, { name: "2 Crónicas", file: "2c" }, { name: "Esdras", file: "esd" },
            { name: "Nehemías", file: "neh" }, { name: "Ester", file: "est" }, { name: "Job", file: "job" },
            { name: "Salmos", file: "sal" }, { name: "Proverbios", file: "pr" }, { name: "Eclesiastés", file: "ec" },
            { name: "Cantares", file: "cnt" }, { name: "Isaías", file: "is" }, { name: "Jeremías", file: "jer" },
            { name: "Lamentaciones", file: "lm" }, { name: "Ezequiel", file: "ez" }, { name: "Daniel", file: "dan" },
            { name: "Oseas", file: "os" }, { name: "Joel", file: "jl" }, { name: "Amós", file: "am" },
            { name: "Abdías", file: "abd" }, { name: "Jonás", file: "jon" }, { name: "Miqueas", file: "mi" },
            { name: "Nahúm", file: "nah" }, { name: "Habacuc", file: "hab" }, { name: "Sofonías", file: "sof" },
            { name: "Hageo", file: "hag" }, { name: "Zacarías", file: "zac" }, { name: "Malaquías", file: "mal" },
            // Nuevo Testamento
            { name: "Mateo", file: "mt" }, { name: "Marcos", file: "mr" }, { name: "Lucas", file: "lc" },
            { name: "Juan", file: "jn" }, { name: "Hechos", file: "ac" }, { name: "Romanos", file: "rom" },
            { name: "1 Corintios", file: "1cor" }, { name: "2 Corintios", file: "2cor" }, { name: "Gálatas", file: "ga" },
            { name: "Efesios", file: "ef" }, { name: "Filipenses", file: "fil" }, { name: "Colosenses", file: "col" },
            { name: "1 Tesalonicenses", file: "1ts" }, { name: "2 Tesalonicenses", file: "2ts" }, { name: "1 Timoteo", file: "1tim" },
            { name: "2 Timoteo", file: "2tim" }, { name: "Tito", file: "tit" }, { name: "Filemón", file: "flm" },
            { name: "Hebreos", file: "heb" }, { name: "Santiago", file: "jac" }, { name: "1 Pedro", file: "1p" },
            { name: "2 Pedro", file: "2p" }, { name: "1 Juan", file: "1jn" }, { name: "2 Juan", file: "2jn" },
            { name: "3 Juan", file: "3jn" }, { name: "Judas", file: "jud" }, { name: "Apocalipsis", file: "rev" }
        ];

        const BASE_PATH = './biblia/procesada/RVR60/';
        const contentArea = document.getElementById('content-area');
        const bookMenu = document.getElementById('book-menu');
        let currentBookData = null;

        // Inicializar la aplicación
        function init() {
            renderBookMenu();
        }

        // Renderizar el menú lateral
        function renderBookMenu() {
            bookMenu.innerHTML = '';
            BOOK_MAP.forEach(book => {
                const btn = document.createElement('button');
                btn.className = 'book-btn';
                btn.textContent = book.name;
                btn.onclick = () => loadBook(book);
                bookMenu.appendChild(btn);
            });
        }

        // Cargar un libro JSON
        async function loadBook(book) {
            // Actualizar estado visual del menú
            document.querySelectorAll('.book-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');

            contentArea.innerHTML = '<div class="loading">Cargando libro...</div>';

            try {
                const response = await fetch(`${BASE_PATH}${book.file}.json`);
                if (!response.ok) {
                    throw new Error(`No se pudo cargar el archivo: ${book.file}.json`);
                }
                currentBookData = await response.json();
                renderChapterList();
            } catch (error) {
                console.error(error);
                contentArea.innerHTML = `
                    <div class="error-msg">
                        <h3>Error al cargar el libro</h3>
                        <p>${error.message}</p>
                        <p>Verifique que el archivo exista en: <code>${BASE_PATH}${book.file}.json</code></p>
                    </div>
                `;
            }
        }

        // Mostrar la lista de capítulos
        function renderChapterList() {
            if (!currentBookData) return;

            // Adaptar a la estructura real: el título suele estar en book.name
            const title = currentBookData.book ? currentBookData.book.name : (currentBookData.title || "Libro");
            const description = currentBookData.description || "";
            
            // chapters es un objeto { "1": {...}, "2": {...} }
            const chaptersObj = currentBookData.chapters || {};
            const chapterKeys = Object.keys(chaptersObj).sort((a, b) => parseInt(a) - parseInt(b));

            let html = `
                <div class="nav-header">
                    <h2 class="book-title">${title}</h2>
                </div>
                <p><em>${description}</em></p>
                <h3>Capítulos</h3>
                <div class="chapters-grid">
            `;

            chapterKeys.forEach(chapterNum => {
                html += `
                    <button class="chapter-btn" onclick="renderVerses('${chapterNum}')">
                        ${chapterNum}
                    </button>
                `;
            });

            html += `</div>`;
            contentArea.innerHTML = html;
            // Scroll al inicio
            document.getElementById('main-content').scrollTop = 0;
        }

        // Mostrar los versículos de un capítulo
        function renderVerses(chapterNum) {
            if (!currentBookData) return;

            const chapterVerses = currentBookData.chapters[chapterNum];
            const bookTitle = currentBookData.book ? currentBookData.book.name : (currentBookData.title || "Libro");

            let html = `
                <div class="nav-header">
                    <button class="back-btn" onclick="renderChapterList()">← Volver</button>
                    <h2 class="book-title">${bookTitle} - Capítulo ${chapterNum}</h2>
                </div>
                <div class="verse-container">
            `;

            if (chapterVerses) {
                const verseKeys = Object.keys(chapterVerses).sort((a, b) => parseInt(a) - parseInt(b));
                
                if (verseKeys.length > 0) {
                    verseKeys.forEach(verseNum => {
                        const text = chapterVerses[verseNum];
                        html += `
                            <div class="verse">
                                <span class="verse-num">${verseNum}</span>
                                ${text}
                            </div>
                        `;
                    });
                } else {
                    html += '<p>No hay versículos disponibles para este capítulo.</p>';
                }
            } else {
                html += '<p>No se encontró el capítulo.</p>';
            }

            html += `</div>`;
            contentArea.innerHTML = html;
            // Scroll al inicio
            document.getElementById('main-content').scrollTop = 0;
        }

        // Iniciar
        init();
    </script>
</body>
</html>